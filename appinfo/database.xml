<?xml version="1.0"?>
<database xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
          xsi:noNamespaceSchemaLocation="https://apps.nextcloud.com/schema/apps/database.xsd">

<!-- Table for Listings -->
<table>
    <name>*dbprefix*listings</name>
    <declaration>
        <field>
            <name>id</name>
            <type>string</type>
            <length>36</length> <!-- Assuming UUIDs -->
            <notnull>true</notnull>
            <primary>true</primary>
        </field>
        <field>
            <name>catalogusId</name>
            <type>string</type>
            <length>255</length>
            <notnull>false</notnull>
        </field>
        <field>
            <name>title</name>
            <type>string</type>
            <length>255</length>
            <notnull>true</notnull>
        </field>
        <field>
            <name>summary</name>
            <type>string</type>
            <length>255</length>
            <notnull>false</notnull>
        </field>
        <field>
            <name>description</name>
            <type>text</type>
            <notnull>false</notnull>
        </field>
        <field>
            <name>search</name>
            <type>string</type>
            <length>255</length>
            <notnull>false</notnull>
        </field>
        <field>
            <name>directory</name>
            <type>string</type>
            <length>255</length>
            <notnull>false</notnull>
        </field>
        <field>
            <name>status</name>
            <type>string</type>
            <length>255</length>
            <notnull>false</notnull>
        </field>
        <field>
            <name>statusCode</name>
            <type>integer</type>
            <length>4</length>
            <notnull>false</notnull>
        </field>
        <field>
            <name>lastSync</name>
            <type>datetime</type>
            <notnull>false</notnull>
        </field>
        <field>
            <name>available</name>
            <type>boolean</type>
            <notnull>false</notnull>
            <default>false</default>
        </field>
        <field>
            <name>default</name>
            <type>boolean</type>
            <notnull>false</notnull>
            <default>false</default>
        </field>
        <index>
            <name>listing_catalogusId_index</name>
            <field>
                <name>catalogusId</name>
            </field>
        </index>
    </declaration>
</table>

<!-- Table for Organisations -->
<table>
    <name>*dbprefix*organisations</name>
    <declaration>
        <field>
            <name>id</name>
            <type>string</type>
            <length>36</length>
            <notnull>true</notnull>
            <primary>true</primary>
        </field>
        <field>
            <name>title</name>
            <type>string</type>
            <length>255</length>
            <notnull>true</notnull>
        </field>
        <field>
            <name>summary</name>
            <type>string</type>
            <length>255</length>
            <notnull>false</notnull>
        </field>
        <field>
            <name>description</name>
            <type>text</type>
            <notnull>false</notnull>
        </field>
        <field>
            <name>oin</name>
            <type>string</type>
            <length>255</length>
            <notnull>false</notnull>
        </field>
        <field>
            <name>tooi</name>
            <type>string</type>
            <length>255</length>
            <notnull>false</notnull>
        </field>
        <field>
            <name>rsin</name>
            <type>string</type>
            <length>9</length>
            <notnull>false</notnull>
        </field>
        <field>
            <name>pki</name>
            <type>string</type>
            <length>255</length>
            <notnull>false</notnull>
        </field>
    </declaration>
</table>

<!-- Table for Publications -->
<table>
    <name>*dbprefix*publications</name>
    <declaration>
        <field>
            <name>id</name>
            <type>string</type>
            <length>36</length>
            <notnull>true</notnull>
            <primary>true</primary>
        </field>
        <field>
            <name>reference</name>
            <type>string</type>
            <length>255</length>
            <notnull>false</notnull>
        </field>
        <field>
            <name>title</name>
            <type>string</type>
            <length>255</length>
            <notnull>true</notnull>
        </field>
        <field>
            <name>summary</name>
            <type>string</type>
            <length>255</length>
            <notnull>false</notnull>
        </field>
        <field>
            <name>description</name>
            <type>text</type>
            <notnull>false</notnull>
        </field>
        <field>
            <name>image</name>
            <type>string</type>
            <length>255</length>
            <notnull>false</notnull>
        </field>
        <field>
            <name>category</name>
            <type>string</type>
            <length>255</length>
            <notnull>false</notnull>
        </field>
        <field>
            <name>portal</name>
            <type>string</type>
            <length>255</length>
            <notnull>false</notnull>
        </field>
        <field>
            <name>featured</name>
            <type>boolean</type>
            <notnull>false</notnull>
            <default>false</default>
        </field>
        <field>
            <name>schema</name>
            <type>string</type>
            <length>255</length>
            <notnull>false</notnull>
        </field>
        <field>
            <name>status</name>
            <type>string</type>
            <length>50</length>
            <notnull>false</notnull>
        </field>
        <field>
            <name>published</name>
            <type>datetime</type>
            <notnull>false</notnull>
        </field>
        <field>
            <name>modified</name>
            <type>datetime</type>
            <notnull>false</notnull>
        </field>
        <!-- Foreign key linking to catalogs table -->
        <field>
            <name>catalog_id</name>
            <type>string</type>
            <length>36</length>
            <notnull>false</notnull>
        </field>
    </declaration>
    <foreignkey>
        <name>fk_publication_catalog</name>
        <local>catalog_id</local>
        <table>*dbprefix*catalogs</table>
        <foreign>id</foreign>
        <ondelete>CASCADE</ondelete>
    </foreignkey>
</table>

<!-- Table for Attachments -->
<table>
    <name>*dbprefix*attachments</name>
    <declaration>
        <field>
            <name>id</name>
            <type>string</type>
            <length>36</length>
            <notnull>true</notnull>
            <primary>true</primary>
        </field>
        <field>
            <name>reference</name>
            <type>string</type>
            <length>255</length>
            <notnull>false</notnull>
        </field>
        <field>
            <name>title</name>
            <type>string</type>
            <length>255</length>
            <notnull>true</notnull>
        </field>
        <field>
            <name>summary</name>
            <type>string</type>
            <length>255</length>
            <notnull>false</notnull>
        </field>
        <field>
            <name>description</name>
            <type>text</type>
            <notnull>false</notnull>
        </field>
        <field>
            <name>accessURL</name>
            <type>string</type>
            <length>255</length>
            <notnull>false</notnull>
        </field>
        <field>
            <name>downloadURL</name>
            <type>string</type>
            <length>255</length>
            <notnull>false</notnull>
        </field>
        <field>
            <name>type</name>
            <type>string</type>
            <length>50</length>
            <notnull>false</notnull>
        </field>
        <field>
            <name>extension</name>
            <type>string</type>
            <length>10</length>
            <notnull>false</notnull>
        </field>
        <field>
            <name>size</name>
            <type>integer</type>
            <length>8</length>
            <notnull>false</notnull>
        </field>
        <field>
            <name>hash</name>
            <type>string</type>
            <length>255</length>
            <notnull>false</notnull>
        </field>
        <field>
            <name>published</name>
            <type>datetime</type>
            <notnull>false</notnull>
        </field>
        <field>
            <name>modified</name>
            <type>datetime</type>
            <notnull>false</notnull>
        </field>
        <!-- Foreign key linking to publications table -->
        <field>
            <name>publication_id</name>
            <type>string</type>
            <length>36</length>
            <notnull>false</notnull>
        </field>
    </declaration>
    <foreignkey>
        <name>fk_attachment_publication</name>
        <local>publication_id</local>
        <table>*dbprefix*publications</table>
        <foreign>id</foreign>
        <ondelete>CASCADE</ondelete>
    </foreignkey>
</table>

<!-- Table for Catalogs -->
<table>
    <name>*dbprefix*catalogs</name>
    <declaration>
        <field>
            <name>id</name>
            <type>string</type>
            <length>36</length>
            <notnull>true</notnull>
            <primary>true</primary>
        </field>
        <field>
            <name>title</name>
            <type>string</type>
            <length>255</length>
            <notnull>true</notnull>
        </field>
        <field>
            <name>summary</name>
            <type>string</type>
            <length>255</length>
            <notnull>false</notnull>
        </field>
        <field>
            <name>description</name>
            <type>text</type>
            <notnull>false</notnull>
        </field>
        <field>
            <name>image</name>
            <type>string</type>
            <length>255</length>
            <notnull>false</notnull>
        </field>
        <field>
            <name>search</name>
            <type>string</type>
            <length>255</length>
            <notnull>false</notnull>
        </field>
        <field>
            <name>listed</name>
            <type>boolean</type>
            <notnull>false</notnull>
            <default>false</default>
        </field>
        <field>
            <name>organisation_id</name>
            <type>string</type>
            <length>36</length>
            <notnull>false</notnull>
        </field>
    </declaration>
    <index>
        <name>catalog_organisation_id_index</name>
        <field>
            <name>organisation_id</name>
        </field>
    </index>
    <foreignkey>
        <name>fk_catalog_organisation</name>
        <local>organisation_id</local>
        <table>*dbprefix*organisations</table>
        <foreign>id</foreign>
        <ondelete>CASCADE</ondelete>
    </foreignkey>
</table>

<!-- Table for Themes -->
<table>
    <name>*dbprefix*themes</name>
    <declaration>
        <field>
            <name>id</name>
            <type>string</type>
            <length>36</length>
            <notnull>true</notnull>
            <primary>true</primary>
        </field>
        <field>
            <name>title</name>
            <type>string</type>
            <length>255</length>
            <notnull>true</notnull>
        </field>
        <field>
            <name>summary</name>
            <type>string</type>
            <length>255</length>
            <notnull>false</notnull>
        </field>
        <field>
            <name>description</name>
            <type>text</type>
            <notnull>false</notnull>
        </field>
        <field>
            <name>image</name>
            <type>string</type>
            <length>255</length>
            <notnull>false</notnull>
        </field>
    </declaration>
</table>

<!-- Table for Metadata (for representing arrays/lists) -->
<table>
    <name>*dbprefix*metadata</name>
    <declaration>
        <field>
            <name>id</name>
            <type>string</type>
            <length>36</length>
            <notnull>true</notnull>
            <primary>true</primary>
        </field>
        <field>
            <name>catalog_id</name>
            <type>string</type>
            <length>36</length>
            <notnull>true</notnull>
        </field>
        <field>
            <name>title</name>
            <type>string</type>
            <length>255</length>
            <notnull>true</notnull>
        </field>
        <field>
            <name>description</name>
            <type>text</type>
            <notnull>false</notnull>
        </field>
    </declaration>
    <foreignkey>
        <name>fk_metadata_catalog</name>
        <local>catalog_id</local>
        <table>*dbprefix*catalogs</table>
        <foreign>id</foreign>
        <ondelete>CASCADE</ondelete>
    </foreignkey>
</table>

</database>
